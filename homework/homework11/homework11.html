<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>Homework 11 — Wiener Process (Euler–Maruyama)</title>

  <!-- Global stylesheet -->
  <link rel="stylesheet" href="../../style.css" />

  <!-- MathJax -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    .controls p { margin: 0.35rem 0; }

    .plot-wrapper {
      width: 100%;
      max-width: 900px;
      margin: 2rem auto;
      padding: 1.2rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);
    }

    canvas {
      width: 100% !important;
      height: 450px !important;
      display: block;
      border-radius: 8px;
      background: #ffffff;
    }
  </style>
</head>

<body>

<header>
  <h1>Statistics — Antonio Elia</h1>
  <p>Homework 11 — Student ID: 2253126</p>
</header>

<main>
<section>

  <h2>1. Introduction</h2>
  <p>
    The aim of this homework is to simulate realizations of a
    <strong>Wiener process</strong> (standard Brownian motion)
    using the <strong>Euler–Maruyama</strong> numerical method.
    A Wiener process satisfies the stochastic differential equation:
  </p>

  <p>
    \[
      dW_t = dB_t,
    \]
  </p>

  <p>
    and the Euler–Maruyama discretization is:
  </p>

  <p>
    \[
      W_{t+\Delta t}
      = W_t + \sqrt{\Delta t}\, Z_t,
      \qquad
      Z_t \sim \mathcal{N}(0,1).
    \]
  </p>

  <h2>2. Controls</h2>

  <div class="controls">
    <p>
      <label><strong>Time horizon \(T\):</strong></label>
      <input id="T" type="number" min="0.1" step="0.1" value="1">
    </p>

    <p>
      <label><strong>Steps (n):</strong></label>
      <input id="steps" type="number" min="10" step="10" value="5000">
    </p>

    <p>
      <label><strong>Number of paths:</strong></label>
      <input id="paths" type="number" min="1" max="20" value="6">
    </p>

    <p>
      <button id="simulateBtn">Simulate</button>
    </p>
  </div>

  <div class="plot-wrapper">
    <h2>3. Plot</h2>
    <canvas id="wienerPlot"></canvas>
  </div>

  <h2>4. Remarks</h2>
  <ul>
    <li>The Wiener process has independent Gaussian increments.</li>
    <li>The variance of increments grows linearly with time.</li>
    <li>As steps increase, the simulation converges to true Brownian motion.</li>
  </ul>

  <a class="button" href="../../index.html">⬅ Back to Home</a>

</section>
</main>

<footer>
  <small>© 2025 — Homework 11 by Antonio Elia (2253126)</small>
</footer>

<script>
/* ------------------------------------------------
   Box–Muller generator for N(0,1)
-------------------------------------------------*/
function normalBoxMuller() {
  let u = 0, v = 0;
  while (u === 0) u = Math.random();
  while (v === 0) v = Math.random();
  return Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * v);
}

/* ------------------------------------------------
   Euler–Maruyama Wiener simulation
-------------------------------------------------*/
function simulateWiener(T, steps, nPaths) {
  const dt = T / steps;
  const sqrtDt = Math.sqrt(dt);

  const paths = [];
  for (let p = 0; p < nPaths; p++) {
    const x = new Array(steps + 1).fill(0);
    paths.push(x);
  }

  for (let i = 0; i < steps; i++) {
    for (let p = 0; p < nPaths; p++) {
      const Z = normalBoxMuller();
      paths[p][i + 1] = paths[p][i] + sqrtDt * Z;
    }
  }

  return paths;
}

/* ------------------------------------------------
   Chart.js rendering
-------------------------------------------------*/
let chart = null;

function chartColor(i) {
  const colors = [
    "#3366cc","#dc3912","#ff9900","#109618","#990099",
    "#3b3eac","#0099c6","#dd4477","#66aa00","#b82e2e"
  ];
  return colors[i % colors.length];
}

function drawChart(paths, T) {
  const steps = paths[0].length - 1;

  const labels = [];
  for (let i = 0; i <= steps; i++) {
    labels.push((i * T / steps).toFixed(3));
  }

  const datasets = paths.map((p, idx) => ({
    label: "Path " + (idx + 1),
    data: p,
    borderWidth: 1,
    pointRadius: 0,
    borderColor: chartColor(idx),
    fill: false
  }));

  if (chart) chart.destroy();

  chart = new Chart(document.getElementById("wienerPlot"), {
    type: "line",
    data: { labels: labels, datasets: datasets },
    options: {
      responsive: true,
      animation: false,
      scales: {
        x: { title: { display: true, text: "t" } },
        y: { title: { display: true, text: "W(t)" } }
      }
    }
  });
}

/* ------------------------------------------------
   Event handler
-------------------------------------------------*/
document.getElementById("simulateBtn").addEventListener("click", () => {
  const T = parseFloat(document.getElementById("T").value);
  const steps = parseInt(document.getElementById("steps").value);
  const nPaths = parseInt(document.getElementById("paths").value);

  const paths = simulateWiener(T, steps, nPaths);
  drawChart(paths, T);
});
</script>

</body>
</html>
